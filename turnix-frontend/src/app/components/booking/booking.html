<<<<<<< HEAD
=======
<div class="booking-container">
  
  <!-- ============================================= -->
  <!-- == PASO 1: SELECCIONAR SERVICIO == -->
  <!-- ============================================= -->
  <div *ngIf="currentStep === 1" class="paso-container">
    <div class="paso-header">
      <h1>Seleccionar Servicio</h1>
      <p class="paso-info">Paso 1 de 3: Elige tu servicio</p>
    </div>

    <!-- Lista de servicios -->
    <div *ngIf="servicios.length > 0; else noServicios" class="servicios-list">
      <div *ngFor="let s of servicios" class="servicio-card">
        <div class="servicio-info">
          <h3>{{ s.nombreServicio }}</h3>
          <p>Duración: {{ s.duracionEstimada }} min.</p>
        </div>
        <div class="servicio-accion">
          <span class="precio">S/ {{ s.precio.toFixed(2) }}</span>
          <button (click)="seleccionarServicio(s)" class="seleccionar-btn">
            Seleccionar
          </button>
        </div>
      </div>
    </div>

    <!-- Mensaje si no se encuentran servicios -->
    <ng-template #noServicios>
      <div class="no-servicios">
        <p>No hay servicios disponibles para este negocio.</p>
      </div>
    </ng-template>
  </div>


  <!-- ============================================= -->
  <!-- == PASO 2: AGENDAR CITA == -->
  <!-- ============================================= -->
  <div *ngIf="currentStep === 2 && servicioSeleccionado" class="paso-container">
    
    <div class="paso-header">
      <h1>Agendar Cita</h1>
      <p class="paso-info">Paso 2 de 3: Elige profesional y hora</p>
    </div>

    <!-- Resumen del servicio seleccionado -->
    <div class="servicio-resumen">
      <span>{{ servicioSeleccionado.nombreServicio }}</span>
      <span>Duración: {{ servicioSeleccionado.duracionEstimada }} min.</span>
      <span>S/ {{ servicioSeleccionado.precio.toFixed(2) }}</span>
    </div>

    <!-- Formulario para agendar -->
    <div class="agendar-form">
      
      <!-- 1. Seleccionar Profesional -->
      <div class="form-group">
        <label for="profesional">Seleccionar Profesional</label>
        <select 
          id="profesional" 
          class="form-control" 
          [(ngModel)]="profesionalSeleccionado"
          (change)="buscarDisponibilidad()"> <!-- Llama a la función al cambiar -->
          <option [ngValue]="null" disabled>Cualquier profesional disponible</option>
          <option *ngFor="let p of profesionales" [value]="p.id">
            {{ p.nombre }} {{ p.apellido }} ({{ p.especialidad }})
          </option>
        </select>
      </div>

      <!-- 2. Seleccionar Fecha -->
      <div class="form-group">
        <label for="fecha">Seleccionar Fecha</label>
        <input 
          type="date" 
          id="fecha" 
          class="form-control"
          [(ngModel)]="fechaSeleccionada"
          (change)="buscarDisponibilidad()"> <!-- Llama a la función al cambiar -->
      </div>
    </div>

    <!-- 3. Horarios Disponibles -->
    <div class="horarios-container">
      <label>Horarios Disponibles</label>
      
      <!-- Mensaje de Carga -->
      <div *ngIf="cargandoHorarios" class="horarios-mensaje">
        <p>Buscando horarios...</p>
      </div>

      <!-- Mensaje de Error / Sin Horarios -->
      <div *ngIf="!cargandoHorarios && errorHorarios" class="horarios-mensaje error">
        <p>{{ errorHorarios }}</p>
      </div>

      <!-- Lista de Horarios -->
      <div *ngIf="!cargandoHorarios && horariosDisponibles.length > 0" class="horarios-grid">
        <button 
          *ngFor="let hora of horariosDisponibles"
          class="hora-btn"
          [class.selected]="hora === horaSeleccionada"
          (click)="seleccionarHora(hora)">
          {{ hora }}
        </button>
      </div>
    </div>

    <!-- 4. Botón de Continuar -->
    <button 
      class="continuar-btn" 
      (click)="continuarReserva()"
      [disabled]="!horaSeleccionada"> 
      Continuar
    </button>
  </div>


  <!-- ============================================= -->
  <!-- == PASO 3: CONFIRMAR RESERVA == -->
  <!-- ============================================= -->
  <div *ngIf="currentStep === 3" class="paso-container">
    <div class="paso-header">
      <h1>Confirmar Reserva</h1>
      <p class="paso-info">Paso 3 de 3: Confirma tus detalles</p>
    </div>
  
    <!-- Resumen de la Cita -->
    <div class="resumen-box">
      <h2>Resumen de tu Cita</h2>
      <!-- Usamos '?' (safe navigation) por si algo es nulo -->
      <p><strong>Servicio:</strong> {{ servicioSeleccionado?.nombreServicio }}</p>
      <p><strong>Precio:</strong> S/ {{ servicioSeleccionado?.precio.toFixed(2) }}</p>
      <p><strong>Profesional:</strong> {{ profesionalSeleccionadoObj?.nombre }} {{ profesionalSeleccionadoObj?.apellido }}</p>
      <p><strong>Fecha:</strong> {{ fechaSeleccionada }}</p>
      <p><strong>Hora:</strong> {{ horaSeleccionada }}</p>
    </div>
  
    <!-- Formulario de Contacto -->
    <div class="form-contacto">
      <h2>Información de Contacto</h2>
      
      <div class="form-group">
        <label for="nombre">Nombre Completo *</label>
        <input type="text" id="nombre" class="form-control" [(ngModel)]="clienteNombre">
      </div>
  
      <div class="form-group">
        <label for="email">Correo Electrónico *</label>
        <input type="email" id="email" class="form-control" [(ngModel)]="clienteEmail">
      </div>
  
      <div class="form-group">
        <label for="telefono">Teléfono *</label>
        <input type="tel" id="telefono" class="form-control" [(ngModel)]="clienteTelefono">
      </div>
  
      <div class="form-group">
        <label for="notas">Notas Adicionales (Opcional)</label>
        <textarea id="notas" class="form-control" [(ngModel)]="clienteNotas" rows="3"></textarea>
      </div>
      
      <!-- Mensaje de Error al Guardar -->
      <div *ngIf="errorAlGuardar" class="horarios-mensaje error">
        <p>{{ errorAlGuardar }}</p>
      </div>
  
      <!-- Botón de Confirmar -->
      <button class="continuar-btn" (click)="finalizarReserva()" [disabled]="estaGuardando">
        <span *ngIf="!estaGuardando">Confirmar Cita</span>
        <span *ngIf="estaGuardando">Confirmando...</span>
      </button>
    </div>
  </div>

  <!-- ============================================= -->
  <!--    PASO 4: ÉXITO == -->
  <!-- ============================================= -->
  <div *ngIf="currentStep === 4" class="paso-container">
    <div class="exito-box">
      <h2>✅ ¡Cita Confirmada!</h2>
      <p>Tu reserva se ha completado con éxito.</p>
      <p>Recibirás un correo de confirmación (ficticio) con los detalles.</p>
      <hr>
      <!-- Mostramos un resumen final -->
      <p><strong>Servicio:</strong> {{ servicioSeleccionado?.nombreServicio }}</p>
      <p><strong>Fecha:</strong> {{ fechaSeleccionada }} a las {{ horaSeleccionada }}</p>
      <p><strong>Con:</strong> {{ profesionalSeleccionadoObj?.nombre }}</p>
      
      <button (click)="volverAlInicio()" class="seleccionar-btn">
        Volver al Inicio
      </button>
    </div>
  </div>

</div>
>>>>>>> origin/abrhyl
